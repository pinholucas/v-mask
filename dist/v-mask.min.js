!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueMask={})}(this,(function(e){"use strict";const t="_",n="function",r=[];function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!i(e))throw new Error("Text-mask:convertMaskToPlaceholder; The mask property must be an array.");if(-1!==e.indexOf(n))throw new Error(`Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.\n\nThe placeholder character that was received is: ${JSON.stringify(n)}\n\nThe mask that was received is: ${JSON.stringify(e)}`);return e.map((e=>e instanceof RegExp?n:e)).join("")}function i(e){return Array.isArray&&Array.isArray(e)||e instanceof Array}function a(e){const t=[];let n;for(;n=e.indexOf("[]"),-1!==n;)t.push(n),e.splice(n,1);return{maskWithoutCaretTraps:e,indexes:t}}const l=[],s="";function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!i(r)){if(typeof r!==n)throw new Error("Text-mask:conformToMask; The mask property must be an array.");r=r(e,c),r=a(r).maskWithoutCaretTraps}const{guide:u=!0,previousConformedValue:f=s,placeholderChar:p=t,placeholder:h=o(r,p),currentCaretPosition:d,keepCharPositions:g}=c,y=!1===u&&void 0!==f,m=e.length,v=f.length,k=h.length,x=r.length,b=m-v,E=b>0,w=d+(E?-b:0),T=w+Math.abs(b);if(!0===g&&!E){let t=s;for(let e=w;e<T;e++)h[e]===p&&(t+=p);e=e.slice(0,w)+t+e.slice(w,m)}const A=e.split(s).map(((e,t)=>({char:e,isNew:t>=w&&t<T})));for(let e=m-1;e>=0;e--){const{char:t}=A[e];if(t!==p){t===h[e>=w&&v===x?e-b:e]&&A.splice(e,1)}}let M=s,V=!1;e:for(let e=0;e<k;e++){const t=h[e];if(t===p){if(A.length>0)for(;A.length>0;){const{char:t,isNew:n}=A.shift();if(t===p&&!0!==y){M+=p;continue e}if(r[e].test(t)){if(!0===g&&!1!==n&&f!==s&&!1!==u&&E){const n=A.length;let r=null;for(let e=0;e<n;e++){const t=A[e];if(t.char!==p&&!1===t.isNew)break;if(t.char===p){r=e;break}}null!==r?(M+=t,A.splice(r,1)):e--}else M+=t;continue e}V=!0}!1===y&&(M+=h.substr(e,k));break}M+=t}if(y&&!1===E){let e=null;for(let t=0;t<M.length;t++)h[t]===p&&(e=t);M=null!==e?M.substr(0,e+1):s}return{conformedValue:M,meta:{someCharsRejected:V}}}const u={__nextCharOptional__:!0},f={"#":/\d/,A:/[a-z]/i,N:/[a-z0-9]/i,"?":u,X:/./},p=e=>(e=>{const t=e.lastIndexOf("/");return new RegExp(e.slice(1,t),e.slice(t+1))})(e.toString().replace(/.(\/)[gmiyus]{0,6}$/,(e=>e.replace("/","?/")))),h=e=>e instanceof RegExp?e:(e=>new RegExp(`/[${(e=>"[\\^$.|?*+()".indexOf(e)>-1?`\\${e}`:e)(e)}]/`))(e);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return e.map(((e,n,r)=>{const o=t[e]||e,i=r[n-1],a=t[i]||i;return o===u?null:a===u?p(h(o)):o})).filter(Boolean)}const g=e=>e instanceof HTMLInputElement?e:e.querySelector("input")||e,y=e=>"function"==typeof e,m=e=>"string"==typeof e;function v(e,t){return Array.isArray(e)?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return d(e.map((e=>e instanceof RegExp?e:"string"==typeof e?e.split(""):null)).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]),t)}(e,t):y(e)?e:m(e)&&e.length>0?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return d(e.split(""),t)}(e,t):e}function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return null===e||Array.isArray(e)||"object"!=typeof e?t:Object.keys(e).reduce(((t,n)=>{const r=e[n];return null===r||r instanceof RegExp?{...t,[n]:r}:t}),t)}const x=function(){const e=new Map,t={previousValue:"",mask:[]};function n(n){return e.get(n)||{...t}}return{partiallyUpdate:function(t,r){e.set(t,{...n(t),...r})},remove:function(t){e.delete(t)},get:n}}();function b(e){((e,t)=>{const n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)})(e,"input")}function E(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{value:n}=e,{previousValue:r,mask:o}=x.get(e),i=n!==r,a=n.length>r.length,l=n&&i&&a;if((t||l)&&o){const{conformedValue:t}=c(n,o,{guide:!1});e.value=t,b(e)}x.partiallyUpdate(e,{previousValue:n})}function w(e,t,n){const r=v(t,n);x.partiallyUpdate(e,{mask:r})}function T(e){return(Array.isArray(e)?e:[e]).filter((e=>m(e)||e instanceof RegExp)).toString()}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=k(e&&e.placeholders);return{beforeMount(e,n){let{value:r}=n;w(e=g(e),r,t),E(e)},updated(e,n){let{value:r,oldValue:o}=n;e=g(e);const i=y(r)||T(o)!==T(r);i&&w(e,r,t),E(e,i)},unmounted(e){e=g(e),x.remove(e)}}}var M=A(),V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.directive("mask",A(t))};e.VueMaskDirective=M,e.VueMaskPlugin=V,e.default=V,Object.defineProperty(e,"__esModule",{value:!0})}));
